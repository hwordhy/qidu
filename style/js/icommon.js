var dialogMod=function(e,t){var a=null,o=function(){a&&(clearTimeout(a),a=null)};$(e).hover(function(){o(),$(t).show()},function(){o(),a=setTimeout(function(){$(t).hide()},50)}),$(t).hover(function(){o(),$(t).show()},function(){o(),a=setTimeout(function(){$(t).hide()},50)})},attendAjax=function(e,t,a,o){$.ajax({type:t,url:"/ajax/people/follow/"+o,success:function(n){n.error?pop_login():1==n.success?"post"==t?(1==a?setTimeout(function(){window.location.reload()},1e3):3==a?$(e).addClass("done").removeAttr("onclick").html("<cite></cite>已关注").removeClass("r"):($(e).attr({"data-attend":0}).html("互相关注").removeClass("r"),$(e).attr("onclick","doneAttend(this,"+o+")"),$(e).closest("li").append('<cite class="redBg"></cite><cite class="hg"></cite>')),layer.msg("关注成功啦！",{icon:1,shade:.3})):"DELETE"==t&&(1==a?setTimeout(function(){window.location.reload()},1e3):0==a?($(e).attr({"data-peopleId":o,"data-attend":""}).html("+关注").addClass("r"),$(e).attr("onclick","addAttend(this,"+o+")"),$(e).closest("li").find(".redBg,.hg").remove()):9==a&&$(e).closest("li").remove(),layer.msg("取关成功啦！",{icon:1,shade:.3})):layer.msg(n.msg,{icon:2,shade:.3})}})},addAttend=function(e,t){var a=$(e),o=a.data("attend");o?attendAjax(a,"post",o,t):attendAjax(a,"post","",t)},doneAttend=function(e,t){var a=$(e),o=a.data("attend");o?attendAjax(a,"DELETE",o,t):attendAjax(a,"DELETE","",t)},removeAttend=function(e,t){var a=$(e);$.ajax({type:"DELETE",url:"/ajax/people/fans/"+t,success:function(e){e.error?alert(e.error.custom):1==e.success?(layer.msg("成功移除粉丝！",{icon:1,shade:.3}),a.closest("li").remove()):layer.msg(e.msg,{icon:2,shade:.3})}})},addShelf=function(e){var t=$(e),a=t.data("add"),o=t.closest("tr"),n=o.find(".bookId").val();$.ajax({type:"get",url:"/ajax/book/"+n+"/bookshelf/add",success:function(e){e.success?a||(layer.msg("已加入书架",{icon:1,shade:.3}),t.text("已在书架").removeAttr("onclick").css("cursor","inherit").parent("a").addClass("donshelf"),t.data("add",!0)):layer.msg(e.msg,{icon:2,shade:.3})},error:function(){layer.msg(data.msg,{icon:2,shade:.3})}})};
